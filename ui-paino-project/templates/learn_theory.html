{% extends "layout.html" %}

{% block content %}

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic Theory</title>
<style>
  /* CSS Styles */
  .container {
    max-width: 600px;
    margin: 0 auto;
    text-align: center;
    padding: 20px;
  }
  .data-display {
    margin-bottom: 20px;
  }
</style>
</head>
<body>

<div class="container">
  <h1>Basic Theory</h1>
  <div class="data-display"></div>
  <button id="prevBtn" disabled>Previous</button>
  <button id="nextBtn">Next</button>
  <p id="quizMessage"></p>
</div>

<script>
  // JSON Data
  const data = [
    { id: 1, name: "Every key on the piano has a letter name. The first one we will learn is C.", image: "basic_theory1.jpeg", next_lesson_id:2, next_quiz_id:0 },
    { id: 2, name: "Going from left to right, middle C is the 4th C note on the piano. C is the first note that we will play in the C major scale.", image: "basic_theory2.jpeg", next_lesson_id:0, next_quiz_id:1 }
  ];

  // DOM Elements
  const dataDisplay = document.querySelector('.data-display');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');

  let currentIndex = 0;

  // Function to display data
  function displayData(index) {
    const currentItem = data[index];
    dataDisplay.innerHTML = `
      <p>${currentItem.name}</p>
    `;
  }

  // Initial data display
  displayData(currentIndex);


  // Function to update URL
  function updateURL(id) {
    const newURL = window.location.href.split('?')[0] + `?id=${id}`;
    window.history.pushState({ path: newURL }, '', newURL);
  }

  // Event listeners for next and previous buttons
  nextBtn.addEventListener('click', () => {
    if (currentIndex < data.length - 1) {
      currentIndex++;
      displayData(currentIndex);
      prevBtn.disabled = false;
      updateURL(data[currentIndex].id);
    }
    if (data[currentIndex].next_quiz_id !== 0) {
      document.getElementById('quizMessage').innerText = "Click next to test your knowledge so far!";
      nextBtn.disabled = false; // Enable Next 
      nextBtn.addEventListener('click', () => {
        console.log("Next button clicked");
        window.location.href = `/quiz/theory`;
    });
    } else {
      document.getElementById('quizMessage').innerText = "";
    }
  });

  prevBtn.addEventListener('click', () => {
    if (currentIndex > 0) {
      currentIndex--;
      displayData(currentIndex);
      nextBtn.disabled = false;
      updateURL(data[currentIndex].id);
    }
    if (currentIndex === 0) {
      prevBtn.disabled = true;
    }
    if (data[currentIndex].next_quiz_id !== 0) {
      document.getElementById('quizMessage').innerText = "Click next to test your knowledge so far!";
    } else {
      document.getElementById('quizMessage').innerText = "";
    }
  });

  // Check next_quiz_id and navigate if not zero
  if (data[currentIndex].next_quiz_id !== 0) {
    document.getElementById('quizMessage').innerText = "Click next to test your knowledge so far!";

  }



</script>

</body>
</html>

{% endblock %}